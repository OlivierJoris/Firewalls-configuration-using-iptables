\documentclass[a4paper, 11pt, oneside]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{fullpage}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{graphicx}
\usepackage{url}
\usepackage{float}
\usepackage{rotating}
\usepackage{titling}
\usepackage[table,xcdraw]{xcolor}
\renewcommand\maketitlehooka{\null\mbox{}\vfill}
\renewcommand\maketitlehookd{\vfill\null}

\newcommand{\ClassName}{INFO-0045: Introduction to Computer Security}
\newcommand{\ProjectName}{Project 1 - Firewalls\\Part 2 - High-Level Rules}
\newcommand{\AcademicYear}{2021 - 2022}

%%%% First page settings %%%%

\title{\ClassName\\\vspace*{0.8cm}\ProjectName\vspace{1cm}}
\author{Maxime Goffart \\180521 \and Olivier Joris\\182113}
\date{\vspace{1cm}Academic year \AcademicYear}

\begin{document}

%%% First page %%%

\begin{titlingpage}
{\let\newpage\relax\maketitle}
\end{titlingpage}

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Firewall 1 (\texttt{FW1})}
\paragraph{}For the first firewall, we have the following NAT table:

\begin{table}[H]
\centering
\resizebox{\textwidth}{!}{%
\begin{tabular}{|l|lccl|clcl|}
\hline
\multicolumn{1}{|c|}{\textbf{\#}} & \multicolumn{4}{c|}{\textbf{Intern}}                                                                                                                                                                                                                                                                                                                        & \multicolumn{4}{c|}{\textbf{Exteren}}                                                                                                                                                                                                                                                                                                                       \\ \hline
                                  & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Source\\ IP\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Source\\ port\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Destination\\ IP\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Destination\\ port\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Source\\ IP\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Source\\ port\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Destination\\ IP\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Destination\\ port\end{tabular}}} \\ \hline
1                                 & \multicolumn{1}{l|}{172.31.5.3}                                                   & \multicolumn{1}{c|}{*}                                                              & \multicolumn{1}{c|}{*}                                                                 & 53                                                                                       & \multicolumn{1}{l|}{172.32.4.100}                                                 & \multicolumn{1}{l|}{5300}                                                           & \multicolumn{1}{c|}{*}                                                                 & 53                                                                                       \\ \hline
2                                 & \multicolumn{1}{l|}{172.31.5.4}                                                   & \multicolumn{1}{c|}{*}                                                              & \multicolumn{1}{c|}{*}                                                                 & 80                                                                                       & \multicolumn{1}{l|}{172.32.4.100}                                                 & \multicolumn{1}{l|}{8000}                                                           & \multicolumn{1}{c|}{*}                                                                 & 80                                                                                       \\ \hline
3                                 & \multicolumn{1}{l|}{172.31.5.4}                                                   & \multicolumn{1}{c|}{*}                                                              & \multicolumn{1}{c|}{*}                                                                 & 443                                                                                      & \multicolumn{1}{l|}{172.32.4.100}                                                 & \multicolumn{1}{l|}{4430}                                                           & \multicolumn{1}{c|}{*}                                                                 & 443                                                                                      \\ \hline
4                                 & \multicolumn{1}{l|}{172.31.6.6}                                                   & \multicolumn{1}{c|}{*}                                                              & \multicolumn{1}{c|}{*}                                                                 & 22                                                                                       & \multicolumn{1}{l|}{172.32.4.100}                                                 & \multicolumn{1}{l|}{2200}                                                           & \multicolumn{1}{c|}{*}                                                                 & 22                                                                                       \\ \hline
5                                 & \multicolumn{1}{l|}{172.32.4.100}                                                 & \multicolumn{1}{l|}{25}                                                             & \multicolumn{1}{l|}{172.31.6.5}                                                        & 25                                                                                       & \multicolumn{1}{c|}{*}                                                            & \multicolumn{1}{c|}{*}                                                              & \multicolumn{1}{l|}{172.32.4.100}                                                      & 25                                                                                       \\ \hline
6                                 & \multicolumn{1}{l|}{172.32.4.100}                                                 & \multicolumn{1}{l|}{993}                                                            & \multicolumn{1}{l|}{172.31.6.5}                                                        & 993                                                                                      & \multicolumn{1}{c|}{*}                                                            & \multicolumn{1}{c|}{*}                                                              & \multicolumn{1}{l|}{172.32.4.100}                                                      & 993                                                                                      \\ \hline
7                                 & \multicolumn{1}{l|}{172.32.4.100}                                                 & \multicolumn{1}{l|}{22}                                                             & \multicolumn{1}{l|}{172.31.6.6}                                                        & 22                                                                                       & \multicolumn{1}{c|}{*}                                                            & \multicolumn{1}{c|}{*}                                                              & \multicolumn{1}{l|}{172.32.4.100}                                                      & 22                                                                                       \\ \hline
\end{tabular}
}
\caption{NAT table for \texttt{FW1}}
\end{table}

\paragraph{}For the first firewall, we have the following table of firewall rules:

\begin{table}[H]
\centering
\resizebox{\textwidth}{!}{%
\begin{tabular}{|llllllll|}
\hline
\multicolumn{1}{|c|}{\textbf{\#}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Source\\ IP\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Source\\ port\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Destination\\ IP\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Destination\\ port\end{tabular}}} & \multicolumn{1}{c|}{\textbf{Protocol}} & \multicolumn{1}{c|}{\textbf{Action}} & \multicolumn{1}{c|}{\textbf{Comments}} \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-mail-ssh in}}                                                                                                                                                                                                                                                                                                                                                                                                                                                               \\ \hline
\multicolumn{1}{|l|}{1}           & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.31.6.5}                                                        & \multicolumn{1}{l|}{25}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & SMTP in                                \\ \hline
\multicolumn{1}{|l|}{2}           & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.31.6.5}                                                        & \multicolumn{1}{l|}{993}                                                                 & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & IMAPS in                               \\ \hline
\multicolumn{1}{|l|}{3}           & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.31.6.6}                                                        & \multicolumn{1}{l|}{22}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & SSH relay in                           \\ \hline
\multicolumn{1}{|l|}{4}           & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.31.6.0/24}                                                     & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block in                               \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-mail-ssh out}}                                                                                                                                                                                                                                                                                                                                                                                                                                                              \\ \hline
\multicolumn{1}{|l|}{5}           & \multicolumn{1}{l|}{172.31.6.5}                                                   & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{25}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & SMTP out                                \\ \hline
\multicolumn{1}{|l|}{6}           & \multicolumn{1}{l|}{172.31.6.6}                                                   & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.32.5.2}                                                        & \multicolumn{1}{l|}{22}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & SSH relay $\rightarrow$ PWEB           \\ \hline
\multicolumn{1}{|l|}{7}           & \multicolumn{1}{l|}{172.31.6.6}                                                   & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{22}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & SSH relay $\rightarrow$ Internet       \\ \hline
\multicolumn{1}{|l|}{8}           & \multicolumn{1}{l|}{172.31.6.0/24}                                                & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block out                              \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-http in}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \\ \hline
\multicolumn{1}{|l|}{9}           & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.31.5.0/24}                                                     & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block in                               \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-http out}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \\ \hline
\multicolumn{1}{|l|}{10}          & \multicolumn{1}{l|}{172.31.5.3}                                                   & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{53}                                                                  & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & LDNS $\rightarrow$ remote DNS   \\ \hline
\multicolumn{1}{|l|}{11}          & \multicolumn{1}{l|}{172.31.5.3}                                                   & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{53}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & LDNS $\rightarrow$ remote DNS   \\ \hline
\multicolumn{1}{|l|}{12}          & \multicolumn{1}{l|}{172.31.5.4}                                                   & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{80}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & HTTP out                               \\ \hline
\multicolumn{1}{|l|}{13}          & \multicolumn{1}{l|}{172.31.5.4}                                                   & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{443}                                                                 & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & HTTPS out                              \\ \hline
\multicolumn{1}{|l|}{14}          & \multicolumn{1}{l|}{172.31.5.0/24}                                                & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block out                              \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-public in}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \\ \hline
\multicolumn{1}{|l|}{15}          & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.32.5.2}                                                        & \multicolumn{1}{l|}{80}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & LWEB HTTP in                           \\ \hline
\multicolumn{1}{|l|}{16}          & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.32.5.2}                                                        & \multicolumn{1}{l|}{443}                                                                 & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & LWEB HTTPS in                          \\ \hline
\multicolumn{1}{|l|}{17}          & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.32.5.3}                                                        & \multicolumn{1}{l|}{53}                                                                  & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & PDNS request in                        \\ \hline
\multicolumn{1}{|l|}{18}          & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.32.5.3}                                                        & \multicolumn{1}{l|}{53}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & PDNS request in                        \\ \hline
\multicolumn{1}{|l|}{19}          & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{172.32.5.0/24}                                                     & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block in                               \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-public out}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                \\ \hline
\multicolumn{1}{|l|}{20}          & \multicolumn{1}{l|}{172.32.5.3}                                                   & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{53}                                                                  & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & PDNS $\rightarrow$ remote DNS   \\ \hline
\multicolumn{1}{|l|}{21}          & \multicolumn{1}{l|}{172.32.5.3}                                                   & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{53}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & PDNS $\rightarrow$ remote DNS   \\ \hline
\multicolumn{1}{|l|}{22}          & \multicolumn{1}{l|}{172.32.5.0/24}                                                & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block out                              \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} default}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \\ \hline
\multicolumn{1}{|l|}{23}          & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Default rule                           \\ \hline
\end{tabular}
}
\caption{High-level rules for \texttt{FW1}}
\end{table}

\section{Firewall 2 (\texttt{FW2})}
\paragraph{}For the second firewall, we have the following table of firewall rules:

\begin{table}[H]
\centering
\resizebox{\textwidth}{!}{%
\begin{tabular}{|llllllll|}
\hline
\multicolumn{1}{|c|}{\textbf{\#}}               & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Source\\ IP\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Source\\ port\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Destination\\ IP\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Destination\\ port\end{tabular}}} & \multicolumn{1}{c|}{\textbf{Protocol}} & \multicolumn{1}{c|}{\textbf{Action}} & \multicolumn{1}{c|}{\textbf{Comments}} \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-lweb in}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \\ \hline
\multicolumn{1}{|l|}{1}                         & \multicolumn{1}{l|}{192.168.1.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.2.2}                                                         & \multicolumn{1}{l|}{80}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & Web team $\rightarrow$ LWEB HTTP       \\ \hline
\multicolumn{1}{|l|}{2}                         & \multicolumn{1}{l|}{192.168.2.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.2.2}                                                         & \multicolumn{1}{l|}{80}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & Desk team $\rightarrow$ LWEB HTTP      \\ \hline
\multicolumn{1}{|l|}{3}                         & \multicolumn{1}{l|}{192.168.1.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.2.2}                                                         & \multicolumn{1}{l|}{21}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & Web team $\rightarrow$ LWEB FTP        \\ \hline
\multicolumn{1}{|l|}{4}                         & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.2.0/24}                                                      & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block in                               \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-lweb out}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \\ \hline
\multicolumn{1}{|l|}{5}                         & \multicolumn{1}{l|}{10.10.2.0/24}                                                 & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block out                              \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-u1 in}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \\ \hline
\multicolumn{1}{|l|}{6}                         & \multicolumn{1}{l|}{10.10.1.6}                                                    & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{192.168.1.0/24}                                                    & \multicolumn{1}{l|}{22}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & In from SSH relay                      \\ \hline
\multicolumn{1}{|l|}{7}                         & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{192.168.1.0/24}                                                    & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block in                               \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-u1 out}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \\ \hline
\multicolumn{1}{|l|}{8}                         & \multicolumn{1}{l|}{192.168.1.2}                                                  & \multicolumn{1}{l|}{*}                                                          & \multicolumn{1}{l|}{10.10.1.2}                                                         & \multicolumn{1}{l|}{67}                                                               & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & DHCP\_R1 $\rightarrow$ DHCP            \\ \hline
\multicolumn{1}{|l|}{9}                         & \multicolumn{1}{l|}{192.168.1.2}                                                  & \multicolumn{1}{l|}{*}                                                          & \multicolumn{1}{l|}{10.10.1.2}                                                         & \multicolumn{1}{l|}{68}                                                               & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & DHCP\_R1 $\rightarrow$ DHCP            \\ \hline
\multicolumn{1}{|l|}{10}                         & \multicolumn{1}{l|}{192.168.1.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.3}                                                         & \multicolumn{1}{l|}{53}                                                                  & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & LDNS requests out                      \\ \hline
\multicolumn{1}{|l|}{11}                         & \multicolumn{1}{l|}{192.168.1.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.3}                                                         & \multicolumn{1}{l|}{53}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & LDNS requests out                      \\ \hline
\multicolumn{1}{|l|}{12}                        & \multicolumn{1}{l|}{192.168.1.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.4}                                                         & \multicolumn{1}{l|}{3128}                                                                & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & HTTP(S) out to proxy                    \\ \hline
\multicolumn{1}{|l|}{13}                        & \multicolumn{1}{l|}{192.168.1.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.6}                                                         & \multicolumn{1}{l|}{22}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & Connections to SSH relay               \\ \hline
\multicolumn{1}{|l|}{14}                        & \multicolumn{1}{l|}{192.168.1.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.5}                                                         & \multicolumn{1}{l|}{25}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & Connections to SMTP                    \\ \hline
\multicolumn{1}{|l|}{15}                        & \multicolumn{1}{l|}{192.168.1.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.5}                                                         & \multicolumn{1}{l|}{143}                                                                 & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & Connections to IMAP                    \\ \hline
\multicolumn{1}{|c|}{{\color[HTML]{000000} 16}} & \multicolumn{1}{l|}{192.168.1.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block out                              \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-u2 in}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \\ \hline
\multicolumn{1}{|l|}{17}                        & \multicolumn{1}{l|}{10.10.1.6}                                                    & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{192.168.2.0/24}                                                    & \multicolumn{1}{l|}{22}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & In from SSH relay                      \\ \hline
\multicolumn{1}{|l|}{18}                        & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{192.168.2.0/24}                                                    & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block in                               \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-u2 out}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \\ \hline
\multicolumn{1}{|l|}{19}                        & \multicolumn{1}{l|}{192.168.2.2}                                                  & \multicolumn{1}{l|}{*}                                                          & \multicolumn{1}{l|}{10.10.1.2}                                                         & \multicolumn{1}{l|}{67}                                                               & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & DHCP\_R2 $\rightarrow$ DHCP            \\ \hline
\multicolumn{1}{|l|}{20}                        & \multicolumn{1}{l|}{192.168.2.2}                                                  & \multicolumn{1}{l|}{*}                                                          & \multicolumn{1}{l|}{10.10.1.2}                                                         & \multicolumn{1}{l|}{68}                                                               & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & DHCP\_R2 $\rightarrow$ DHCP            \\ \hline
\multicolumn{1}{|l|}{21}                        & \multicolumn{1}{l|}{192.168.2.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.3}                                                         & \multicolumn{1}{l|}{53}                                                                  & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & LDNS requests out                      \\ \hline
\multicolumn{1}{|l|}{22}                        & \multicolumn{1}{l|}{192.168.2.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.3}                                                         & \multicolumn{1}{l|}{53}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & LDNS requests out                      \\ \hline
\multicolumn{1}{|l|}{23}                        & \multicolumn{1}{l|}{192.168.2.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.4}                                                         & \multicolumn{1}{l|}{3128}                                                                & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & HTTP(S) out to proxy                   \\ \hline
\multicolumn{1}{|l|}{24}                        & \multicolumn{1}{l|}{192.168.2.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.5}                                                        & \multicolumn{1}{l|}{25}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & Connections to SMTP                    \\ \hline
\multicolumn{1}{|l|}{25}                        & \multicolumn{1}{l|}{192.168.2.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.5}                                                         & \multicolumn{1}{l|}{143}                                                                 & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & Connections to IMAP                    \\ \hline
\multicolumn{1}{|l|}{26}                        & \multicolumn{1}{l|}{192.168.2.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block out                              \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-all-sandwich in}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \\ \hline
\multicolumn{1}{|l|}{27}                        & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.1.0/24}                                                      & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block in                               \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-all-sandwich out}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \\ \hline
\multicolumn{1}{|l|}{28}                        & \multicolumn{1}{l|}{10.10.1.0/24}                                                 & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block out                              \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} default}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \\ \hline
\multicolumn{1}{|l|}{29}                        & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Default rule                           \\ \hline
\end{tabular}
}
\caption{High-level rules for \texttt{FW2}}
\end{table}

\section{Firewall 3 (\texttt{FW3})}
\paragraph{}For the third firewall, we have the following table of firewall rules:

\begin{table}[H]
\centering
\resizebox{\textwidth}{!}{%
    \begin{tabular}{|llllllll|}
\hline
\multicolumn{1}{|c|}{\textbf{\#}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Source\\ IP\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Source\\ port\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Destination\\ IP\end{tabular}}} & \multicolumn{1}{c|}{\textbf{\begin{tabular}[c]{@{}c@{}}Destination\\ port\end{tabular}}} & \multicolumn{1}{c|}{\textbf{Protocol}} & \multicolumn{1}{c|}{\textbf{Action}} & \multicolumn{1}{c|}{\textbf{Comments}} \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-nfs in}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \\ \hline
\multicolumn{1}{|l|}{1}           & \multicolumn{1}{l|}{192.168.3.2}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.2}                                                        & \multicolumn{1}{l|}{111}                                                                 & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & HONEYPOT $\rightarrow$ NFS             \\ \hline
\multicolumn{1}{|l|}{2}           & \multicolumn{1}{l|}{192.168.3.2}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.2}                                                        & \multicolumn{1}{l|}{111}                                                                 & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & HONEYPOT $\rightarrow$ NFS             \\ \hline
\multicolumn{1}{|l|}{3}           & \multicolumn{1}{l|}{192.168.3.2}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.2}                                                        & \multicolumn{1}{l|}{2046}                                                                & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & HONEYPOT $\rightarrow$ NFS             \\ \hline
\multicolumn{1}{|l|}{4}           & \multicolumn{1}{l|}{192.168.3.2}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.2}                                                        & \multicolumn{1}{l|}{2046}                                                                & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & HONEYPOT $\rightarrow$ NFS             \\ \hline
\multicolumn{1}{|l|}{5}           & \multicolumn{1}{l|}{192.168.3.2}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.2}                                                        & \multicolumn{1}{l|}{2047}                                                                & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & HONEYPOT $\rightarrow$ NFS             \\ \hline
\multicolumn{1}{|l|}{6}           & \multicolumn{1}{l|}{192.168.3.2}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.2}                                                        & \multicolumn{1}{l|}{2047}                                                                & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & HONEYPOT $\rightarrow$ NFS             \\ \hline
\multicolumn{1}{|l|}{7}           & \multicolumn{1}{l|}{192.168.3.2}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.2}                                                        & \multicolumn{1}{l|}{2048}                                                                & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & HONEYPOT $\rightarrow$ NFS             \\ \hline
\multicolumn{1}{|l|}{8}           & \multicolumn{1}{l|}{192.168.3.2}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.2}                                                        & \multicolumn{1}{l|}{2048}                                                                & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & HONEYPOT $\rightarrow$ NFS             \\ \hline
\multicolumn{1}{|l|}{9}           & \multicolumn{1}{l|}{192.168.3.2}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.2}                                                        & \multicolumn{1}{l|}{2049}                                                                & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & HONEYPOT $\rightarrow$ NFS             \\ \hline
\multicolumn{1}{|l|}{10}          & \multicolumn{1}{l|}{192.168.3.2}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.2}                                                        & \multicolumn{1}{l|}{2049}                                                                & \multicolumn{1}{l|}{UDP}               & \multicolumn{1}{l|}{Accept}          & HONEYPOT $\rightarrow$ NFS             \\ \hline
\multicolumn{1}{|l|}{11}          & \multicolumn{1}{l|}{192.168.3.3}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.3}                                                         & \multicolumn{1}{l|}{873}                                                                 & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & U3 $\rightarrow$ RSYNC                 \\ \hline
\multicolumn{1}{|l|}{12}          & \multicolumn{1}{l|}{10.10.4.6}                                                    & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.3}                                                      & \multicolumn{1}{l|}{22}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & SSH $\rightarrow$ RSYNC                \\ \hline
\multicolumn{1}{|l|}{13}          & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.3.0/24}                                                      & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block in                               \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-nfs out}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \\ \hline
\multicolumn{1}{|l|}{14}          & \multicolumn{1}{l|}{10.10.3.0/24}                                                 & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block out                              \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-u3 in}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \\ \hline
\multicolumn{1}{|l|}{15}          & \multicolumn{1}{l|}{10.10.4.6}                                                    & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{192.168.3.2}                                                       & \multicolumn{1}{l|}{22}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & SSH $\rightarrow$ HONEYPOT             \\ \hline
\multicolumn{1}{|l|}{16}          & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{192.168.3.0/24}                                                    & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block in                               \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-u3 out}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \\ \hline
\multicolumn{1}{|l|}{17}          & \multicolumn{1}{l|}{192.168.3.3}                                                  & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.4.6}                                                         & \multicolumn{1}{l|}{22}                                                                  & \multicolumn{1}{l|}{TCP}               & \multicolumn{1}{l|}{Accept}          & U3 $\rightarrow$ SSH                   \\ \hline
\multicolumn{1}{|l|}{18}          & \multicolumn{1}{l|}{192.168.3.0/24}                                               & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block out                              \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-ssh in}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \\ \hline
\multicolumn{1}{|l|}{19}          & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{10.10.4.0/24}                                                      & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block in                               \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} z-ssh out}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \\ \hline
\multicolumn{1}{|l|}{20}          & \multicolumn{1}{l|}{10.10.4.0/24}                                                 & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Block out                              \\ \hline
\multicolumn{8}{|c|}{{\color[HTML]{FE0000} default}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \\ \hline
\multicolumn{1}{|l|}{21}          & \multicolumn{1}{l|}{*}                                                            & \multicolumn{1}{l|}{*}                                                              & \multicolumn{1}{l|}{*}                                                                 & \multicolumn{1}{l|}{*}                                                                   & \multicolumn{1}{l|}{*}                 & \multicolumn{1}{l|}{Log and drop}    & Default rule                           \\ \hline
\end{tabular}
}
\caption{High-level rules for \texttt{FW3}}
\end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}